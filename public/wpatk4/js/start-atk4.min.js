jQuery.atk4||function($){$.atk4=function(readycheck,lastcall){return $.atk4._onReady(readycheck,lastcall)};$.univ=function(){$.univ.ignore=false;return $.univ};$.univ._import=function(name,fn){$.univ[name]=function(){var ret;if(!$.univ.ignore){ret=fn.apply($.univ,arguments)}return ret?ret:$.univ}};$.fn.extend({univ:function(){var u=new $.univ;u.jquery=this;return u}});$.extend($.atk4,{verison:"2.0",production:false,initialised:false,successMessage:function(msg,system){if(system&&this.production){return}window.console.log("Success: ",msg)},loading:0,_readyList:[],_readyLast:undefined,_refreshTimeout:function(){if(document.session_timeout){if(document.session_timeout_timer1){clearTimeout(document.session_timeout_timer1)}if(document.session_timeout_timer2){clearTimeout(document.session_timeout_timer2)}document.session_timeout_timer1=setTimeout(function(){if($.univ&&$.univ().successMessage){$.univ().successMessage("Your session will expire in 1 minute due to lack of activity")}},(document.session_timeout-1)*60*1e3);document.session_timeout_timer2=setTimeout(function(){if($.univ()){$.univ().dialogOK("Session timeout","You have been inactive for "+document.session_timeout+" minutes. You will need to log-in again",function(){document.location="/"})}else{window.alert("Your session have expired");document.location="/"}},document.session_timeout*60*1e3)}},get:function(url,data,callback,load_end_callback,post){var self=this;if($.isFunction(data)){callback=data;data=null}var timeout=setTimeout(function(){self._stillLoading(url)},2e3);if(typeof url==="object"&&url[0]){url=$.atk4.addArgument(url)}if(typeof url==="string"){url={url:url}}this.loading++;return $.ajax($.extend({type:post?"POST":"GET",dataType:"html",data:data,beforeSend:function(xhr){xhr.setRequestHeader("X-ATK4-Timeout","true")},success:function(res){clearTimeout(timeout);$.atk4._refreshTimeout();if(load_end_callback){load_end_callback()}if($.atk4._checkSession(res)&&callback){callback(res)}if(!--$.atk4.loading){$.atk4._readyExec()}},error:function(a,b,c){clearTimeout(timeout);$.atk4._refreshTimeout();if(load_end_callback){load_end_callback()}$.atk4._ajaxError(url,a,b,c);if(!--$.atk4.loading){$.atk4._readyExec()}}},url))},_stillLoading:function(url){if(this.loading){window.console.log("Slow loading of: ",url,"remaining:",this.loading)}},_ajaxError:function(url,a,b,c){window.console.error("Failed to load file: ",url," (",a,b,c,")")},_checkSession:function(text){if(text.substr(0,7)==="ERROR: "){var msg=text.substr(7);window.alert(msg);return false}if($.trim(text)==="SESSION TIMEOUT"){window.alert("session has timed out");document.location="/";return false}return true},_onReady:function(fn,lastcall){if(lastcall){if(!this.loading){fn.call(document)}else{if(this._readyLast){var prev=this._readyLast;this._readyLast=function(){prev();fn()}}else{this._readyLast=fn}}return}if(!this.loading){fn.call(document)}else{this._readyList.push(fn)}},_readyExec:function(){while(this._readyList.length){var fn=this._readyList.shift();fn.call(document);if($.atk4.loading){return}}if(this._readyLast){var x=this._readyLast;this._readyLast=undefined;x.call(document)}},_includes:{},includeJS:function(url,nocache){if(this._isIncluded(url)&&!nocache){return}this.get(url,function(code){try{eval(code)}catch(e){if(String(e).indexOf("Parse error")){if($.atk4.production){window.console.log("Eval failed for "+url)}else{window.console.error("Eval failed for "+url+", trying to include directly for debugging");$.atk4._evalJS(url)}}else{window.console.error("Eval error: "+e)}}})},_evalJS:function(url,clean){var old=document.getElementById("atk4_eval_clean");if(old!==null){old.parentNode.removeChild(old)}var head=document.getElementsByTagName("head")[0];var script=document.createElement("script");if(clean){script.id="atk4_eval_clean"}script.type="text/javascript";script.src=url;head.appendChild(script)},includeCSS:function(url){if(this._isIncluded(url)){return}$("<link>").appendTo($("head")).attr({type:"text/css",rel:"stylesheet"}).attr("href",url)},_isIncluded:function(url){if(this._includes[url]){return true}this._includes[url]=true;return false},addArgument:function(url,a,b){if(typeof url=="object"){if(url[0]){var u=url[0];delete url[0];$.each(url,function(_a,_b){u=$.atk4.addArgument(u,_a,_b)});url=u}}if(typeof b=="object"){console.log(b);var u=url;$.each(b,function(_a,_b){u=$.atk4.addArgument(u,_a,_b)});return u}if(typeof a=="undefined")return url;if(b)a+="="+encodeURIComponent(b);return url+(url.indexOf("?")==-1?"?":"&")+a}})}(jQuery);if(!window.console){window.region=$;window.console={log:function(){},error:function(){}}}