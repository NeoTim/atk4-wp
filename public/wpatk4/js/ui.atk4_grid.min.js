jQuery.widget("ui.atk4_grid",{width:0,name:undefined,row_prototype:undefined,base_url:undefined,loading:false,_create:function(){var self=this;var len=window.location.href.indexOf("#");if(len<0)len=window.location.href.length;this.base_url=window.location.href.substr(0,len);if(this.options.base_url)this.base_url=this.options.base_url;this.element.addClass("atk4_grid");this.name=this.element.attr("id")},highlightRow:function(id){var el=this.element.find("tbody").eq(0).children("tr[data-id="+id+"]");el.effect("highlight",3e3)},removeRow:function(id){var el=this.element.find("tbody").eq(0).children("tr[data-id="+id+"]");var grid=this;el.children().animate({color:"white"},function(){el.remove();grid.checkIfEmptyTable(true)})},requestData:function(options,fn){options["expanded"]=this.name;var url=this.base_url;if(options){for(var key in options){if(url.indexOf("?")==-1)url+="?";else url+="&";url+=key+"="+options[key]}}jQuery.get(url,fn)},reloadRow:function(id,fn){var grid=this;grid.element.find("tr[rel=new]").attr("rel",id);var args={};args[this.name+"_reload_row"]=id;args[0]=this.base_url;grid.element.find("tr[rel="+id+"]").atk4_reload(args,[],function(){if(fn)fn;else grid.highlightRow(id)})},reload:function(){var url=this.base_url;url=jQuery.atk4.addArgument(url,"cut_object="+this.name);this.element.atk4_grid("destroy");this.element.atk4_reload(url)},reloadData:function(q){var url=this.base_url;var t=this;url=jQuery.atk4.addArgument(url,"cut_object="+this.name);url=jQuery.atk4.addArgument(url,"cut_region=grid_content");jQuery.each(q,function(k,v){url=jQuery.atk4.addArgument(url,escape(k)+"="+escape(v))});t.element.find(".grid_content").atk4_reload(url,null,function(){t.initTableContent()})},checkIfEmptyTable:function(ok_to_reload){this.element.find(".lister_notfound_nojs").remove();if(x=this.element.find("tbody").children("tr").not(":hidden").length){this.element.find(".lister_notfound").hide()}else{if(ok_to_reload){var p=this.element.find(".grid_paginator");var l=p.children().length;if(l){}}this.element.find(".lister_notfound").show()}}});