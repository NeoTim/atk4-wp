jQuery.widget("ui.atk4_menu",{options:{target:"#Content",submenus:false,cut_object:false},_create:function(){var self=this;self.element.addClass("atk4_menu");this.element.find("a").click(function(e){e.preventDefault();if(self.options.submenus){if(self.options.submenu_aciton){self.options.submenu_aciton()}else{jQuery(this).closest("ul,.menu,.header_subnav").find(".submenu-active").removeClass("submenu-active").addClass("submenu").hide()}}var url=jQuery(this).attr("href");if(jQuery(this).attr("data-hash")){}if(self.options.cut_object)url={0:url,cut_object:self.options.cut_object,cut_page:null};var t=this;jQuery(self.options.target).atk4_load(url,function(){self.element.find(".current").removeClass("current");jQuery(t).addClass("current")})})},openPage:function(h,fn){menu=this;console.log("looking for ",h);var el=this.element.find("a[href="+h+"]");if(el.length){if(!fn)fn=jQuery.atk4.readyLast;jQuery.atk4.readyLast=undefined;el.closest("li").find("a").eq(0).click();menu.click(el,h,fn)}},click:function(el,url,fn){if(el.hasClass("current")){this.onClick(el,url,fn);return}el.parent().parent().find(".current").each(function(){var next=jQuery(this).removeClass("current").filter("a").next();if(next.is("div"))next.hide()});el.addClass("current").parent().addClass("current");var next=el.addClass("current").next();if(next.is("div"))next.show();this.onClick(el,url,fn)},onClick:function(el,url,fn){if(this.options["callback"]){this.options["callback"].call(el,url,fn)}else{if(el.hasClass("nav_item"))return;if(url!="#")jQuery("#Content").atk4_load(url,fn)}}});